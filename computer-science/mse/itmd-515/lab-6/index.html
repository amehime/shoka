<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#FFF"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"><link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="alternate" type="application/rss+xml" title="優萌初華" href="https://shoka.lostyu.me/rss.xml"><link rel="alternate" type="application/atom+xml" title="優萌初華" href="https://shoka.lostyu.me/atom.xml"><link rel="alternate" type="application/json" title="優萌初華" href="https://shoka.lostyu.me/feed.json"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/css/app.css?v=0.2.5"><meta name="keywords" content="Java"><link rel="canonical" href="https://shoka.lostyu.me/computer-science/mse/itmd-515/lab-6/"><meta name="description" content="# Notes # Collections of Basic Types @CollectionTable  @ElementCollection  (Goncalves Ex23) Useful for storing Set or List of basic types such as Strings or Integers    @MapKeyColumn  (Goncalves Ex24)"><meta property="og:type" content="article"><meta property="og:title" content="Lab 6. JPA Relationships"><meta property="og:url" content="https://shoka.lostyu.me/computer-science/mse/itmd-515/lab-6/"><meta property="og:site_name" content="優萌初華"><meta property="og:description" content="# Notes # Collections of Basic Types @CollectionTable  @ElementCollection  (Goncalves Ex23) Useful for storing Set or List of basic types such as Strings or Integers    @MapKeyColumn  (Goncalves Ex24)"><meta property="og:locale" content="en_US"><meta property="og:image" content="https://i.loli.net/2021/03/01/B2yFcbMXptqjxHC.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/01/6gxQI47wED2JB19.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/01/jlIpR3JdqbhCoy9.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/02/RPW31f4bgwK6mEy.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/02/Ej5OdN41PiWIgSQ.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/02/NrUGYiJaXFWvqk2.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/02/CAWSJxbtOZy9Kqz.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/02/EHmDtBRiZsqGN4I.jpg"><meta property="og:image" content="https://i.loli.net/2021/03/02/USbrjRK1wWfdLNF.jpg"><meta property="article:published_time" content="2021-02-26T08:46:55.000Z"><meta property="article:modified_time" content="2021-02-26T08:46:55.000Z"><meta property="article:author" content="Ruri Shimotsuki"><meta property="article:tag" content="Java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://i.loli.net/2021/03/01/B2yFcbMXptqjxHC.jpg"><meta name="twitter:creator" content="@amehime"><title>Lab 6. JPA Relationships - ITMD 515. Advanced Software Programming - Master of Software Engineering - 计算机科学 | Yume Shoka = 優萌初華 = 有夢書架</title><meta name="generator" content="Hexo 6.3.0"></head><body itemscope itemtype="http://schema.org/WebPage"><div id="loading"><div class="cat"><div class="body"></div><div class="head"><div class="face"></div></div><div class="foot"><div class="tummy-end"></div><div class="bottom"></div><div class="legs left"></div><div class="legs right"></div></div><div class="paw"><div class="hands left"></div><div class="hands right"></div></div></div></div><div id="container"><header id="header" itemscope itemtype="http://schema.org/WPHeader"><div class="inner"><div id="brand"><div class="pjax"><h1 itemprop="name headline">Lab 6. JPA Relationships</h1><div class="meta"><span class="item" title="Created: 2021-02-26 16:46:55"><span class="icon"><i class="ic i-calendar"></i> </span><span class="text">Posted on</span> <time itemprop="dateCreated datePublished" datetime="2021-02-26T16:46:55+08:00">2021-02-26</time> </span><span class="item" title="Symbols count in article"><span class="icon"><i class="ic i-pen"></i> </span><span class="text">Symbols count in article</span> <span>20k</span> <span class="text">words</span> </span><span class="item" title="Reading time"><span class="icon"><i class="ic i-clock"></i> </span><span class="text">Reading time</span> <span>19 mins.</span></span></div></div></div><nav id="nav"><div class="inner"><div class="toggle"><div class="lines" aria-label="切换导航栏"><span class="line"></span> <span class="line"></span> <span class="line"></span></div></div><ul class="menu"><li class="item title"><a href="/" rel="start">Yume Shoka</a></li></ul><ul class="right"><li class="item theme"><i class="ic i-sun"></i></li><li class="item search"><i class="ic i-search"></i></li></ul></div></nav></div><div id="imgs" class="pjax"><ul><li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/a1f3404a5032323ea4857ac5a6354d2f.jpg"></li><li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/8a8076ea9cbc7d677dd42ad84d4e3ebd.jpg"></li><li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/0a30d7eca259366c104d2fbfe515dc0e.jpg"></li><li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/d424b2656229a0e3718abfd0a05bbff7.jpg"></li><li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/a3893b60653fe5923434b1eef4de7c7b.jpg"></li><li class="item" data-background-image="https://img.timelessq.com/images/2022/07/26/f85e0c5cc31d609ad0b6e48a88040ecb.jpg"></li></ul></div></header><div id="waves"><svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z"/></defs><g class="parallax"><use xlink:href="#gentle-wave" x="48" y="0"/><use xlink:href="#gentle-wave" x="48" y="3"/><use xlink:href="#gentle-wave" x="48" y="5"/><use xlink:href="#gentle-wave" x="48" y="7"/></g></svg></div><main><div class="inner"><div id="main" class="pjax"><div class="article wrap"><div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList"><i class="ic i-home"></i> <span><a href="/">Home</a></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/" itemprop="item" rel="index" title="In 计算机科学"><span itemprop="name">计算机科学</span></a><meta itemprop="position" content="1"></span><i class="ic i-angle-right"></i> <span itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/mse/" itemprop="item" rel="index" title="In Master of Software Engineering"><span itemprop="name">Master of Software Engineering</span></a><meta itemprop="position" content="2"></span><i class="ic i-angle-right"></i> <span class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/computer-science/mse/itmd-515/" itemprop="item" rel="index" title="In ITMD 515. Advanced Software Programming"><span itemprop="name">ITMD 515. Advanced Software Programming</span></a><meta itemprop="position" content="3"></span></div><article itemscope itemtype="http://schema.org/Article" class="post block" lang="en"><link itemprop="mainEntityOfPage" href="https://shoka.lostyu.me/computer-science/mse/itmd-515/lab-6/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.jpg"><meta itemprop="name" content="Ruri Shimotsuki"><meta itemprop="description" content="有夢書架, 琉璃的医学 & 编程笔记"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="優萌初華"></span><div class="body md" itemprop="articleBody"><h1 id="notes"><a class="anchor" href="#notes">#</a> Notes</h1><h2 id="collections-of-basic-types"><a class="anchor" href="#collections-of-basic-types">#</a> Collections of Basic Types</h2><p><code>@CollectionTable</code></p><dl><dt><code>@ElementCollection</code> (Goncalves Ex23)</dt><dd>Useful for storing Set or List of basic types such as Strings or Integers</dd></dl><p><img data-src="https://i.loli.net/2021/03/01/B2yFcbMXptqjxHC.jpg" alt=""></p><dl><dt><code>@MapKeyColumn</code> (Goncalves Ex24)</dt><dd>Useful for storing Map of basic types such as <code>&lt;Integer,String&gt;</code></dd></dl><p><img data-src="https://i.loli.net/2021/03/01/6gxQI47wED2JB19.jpg" alt=""></p><h2 id="relationship-mapping"><a class="anchor" href="#relationship-mapping">#</a> Relationship Mapping</h2><ul><li>Entities have relationships with other entities</li><li>Direction or Navigation<ul><li>Unidirectional 单向</li><li>Bidirectional 双向</li></ul></li><li>Multiplicity or Cardinality<ul><li>One-to-one</li><li>One-to-many</li><li>Many-to-one</li><li>Many-to-many</li></ul></li></ul><p>从左到右读，Many Appointment to One Pet</p><h3 id="unidirectional"><a class="anchor" href="#unidirectional">#</a> Unidirectional</h3><ul><li>Has only an owning side 只有一面</li><li>In this example, you can only access customer addresses via the Customer entity (the owner)<br>在此示例中，您只能通过客户实体访问客户地址</li></ul><p><img data-src="https://i.loli.net/2021/03/01/jlIpR3JdqbhCoy9.jpg" alt=""></p><h3 id="bidirectional"><a class="anchor" href="#bidirectional">#</a> Bidirectional</h3><ul><li>Has both an owning and an inverse side</li><li>In this example, you can access addresses from the customer entity, but you can also access customers from the address entity<br>在此示例中，您可以从客户实体访问地址，但也可以从地址实体访问客户</li></ul><p><img data-src="https://i.loli.net/2021/03/02/RPW31f4bgwK6mEy.jpg" alt=""></p><h3 id="one-to-one"><a class="anchor" href="#one-to-one">#</a> One-to-One</h3><p>Each entity instance is related to a single instance of another entity.<br>每个实体实例都与另一个实体的单个实例相关。</p><dl><dt><code>@OneToOne</code> Unidirectional</dt><dd><ul><li>Annotation goes on owning side</li><li>FK is on owning entity’s table</li><li>Use <code>@JoinColumn</code> on owner to customize FK<ul><li>Goncalves Ex34 (CBE)</li><li>Goncalves Ex39 (with <code>@JoinColumn</code> )</li></ul></li></ul></dd><dt><code>@OneToOne</code> Bidirectional</dt><dd><ul><li>Annotation goes on both sides</li><li><strong>Inverse</strong> side uses mappedBy to point to owner</li><li>FK is on <strong>owning</strong> entity’s table</li><li>Use <code>@JoinColumn</code> on <strong>owner</strong> to customize FK</li><li>Application must manage both sides of the relationship<ul><li>Can be done programmatically</li><li>Can be done through setter methods</li></ul></li></ul></dd></dl><h3 id="one-to-many"><a class="anchor" href="#one-to-many">#</a> One-to-Many</h3><p>An entity instance can be related to multiple instances of the other entities.<br>一个实体实例可以与其他实体的多个实例相关。</p><dl><dt><code>@JoinTable</code> (Goncalves Ex43)</dt><dd><ul><li>name</li><li>joinColumns</li><li>inverseJoinColumns</li></ul></dd></dl><p><img data-src="https://i.loli.net/2021/03/02/Ej5OdN41PiWIgSQ.jpg" alt=""></p><dl><dt><code>@OneToMany</code> Unidirectional</dt><dd><ul><li>Annotation goes on owning side</li><li>Defaults to join table</li><li>Use <code>@JoinTable</code> on owner to customize FKs in join table<ul><li>joinColumns</li><li>inverseJoinColumns</li></ul></li></ul></dd></dl><h3 id="many-to-one"><a class="anchor" href="#many-to-one">#</a> Many-to-One</h3><p>Multiple instances of an entity can be related to a single instance of the other entity. This multiplicity is the opposite of a one-to-many relationship.<br>一个实体的多个实例可以与另一个实体的单个实例相关。这种多样性与一对多关系相反。</p><p><code>@JoinColumn</code><br><img data-src="https://i.loli.net/2021/03/02/NrUGYiJaXFWvqk2.jpg" alt=""></p><dl><dt><code>@ManyToOne</code> Unidirectional</dt><dd><ul><li>Annotation goes on owning side (always the many side for ManyToOne)</li><li>Defaults to join column (FK on the many side)</li><li>Use <code>@JoinColumn</code> on owner to customize FK</li></ul></dd><dt><code>@ManyToOne</code> and <code>@OneToMany</code> Bidirectional</dt><dd><ul><li>Annotation goes on both sides</li><li><strong>Inverse</strong> (OneToMany) side uses mappedBy to point to owner</li><li>Defaults to join column (FK on many side)</li><li>Use <code>@JoinColumn</code> on owner to customize FK</li><li>Application must manage both sides of the relationship<ul><li>Can be done through setter and add methods</li></ul></li></ul></dd></dl><h3 id="many-to-many"><a class="anchor" href="#many-to-many">#</a> Many-to-Many</h3><p>The entity instances can be related to multiple instances of each other.</p><p><img data-src="https://i.loli.net/2021/03/02/CAWSJxbtOZy9Kqz.jpg" alt=""></p><dl><dt><code>@ManyToMany</code></dt><dd><ul><li>Goncalves Ex46</li><li><code>@JoinTable</code> with joinColumns and inverseJoinColumns, and mappedBy on inverse Annotation goes on both sides</li><li>Use <code>@JoinTable</code> on owner to customize FKs in join table<ul><li>joinColumns</li><li>inverseJoinColumns</li></ul></li><li>Inverse side uses mappedBy to point to owner</li><li>Application must manage both sides of the relationship<ul><li>Can be done through add methods – remember these are collections</li></ul></li></ul></dd></dl><h3 id="relationship-mapping-tips"><a class="anchor" href="#relationship-mapping-tips">#</a> Relationship Mapping Tips</h3><ul><li>Navigating relationships on a detached entity will cause exceptions<br>在独立实体上导航关系将导致异常</li><li>Application bears the responsibility of maintaining relationships between objects<br>应用程序负责维护对象之间的关系<ul><li>We can use setters and add methods<br>我们可以使用设置器和添加方法</li></ul></li><li>Don’t forget to initialize collections!<br>不要忘记初始化集合！</li><li>Table/Entity with FK is the owner</li></ul><h3 id="bidirectional-relationship-rules"><a class="anchor" href="#bidirectional-relationship-rules">#</a> Bidirectional Relationship Rules</h3><ul><li><p>The inverse side of a bidirectional relationship must refer to its owning side by using the mappedBy element of the <code>@OneToOne</code> , <code>@OneToMany</code> , or <code>@ManyToMany</code> annotation. The mappedBy element designates the property or field in the entity that is the owner of the relationship.</p></li><li><p>The many side of many-to-one bidirectional relationships must not define the mappedBy element. The many side is always the owning side of the relationship.</p></li><li><p>For one-to-one bidirectional relationships, the owning side corresponds to the side that contains the corresponding foreign key.</p></li><li><p>For many-to-many bidirectional relationships, either side may be the owning side.</p></li></ul><figure class="highlight java"><figcaption data-lang="java"><span>Pet.java</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Entity</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token annotation punctuation">@Table</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"PET"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token annotation punctuation">@NamedQuery</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Pet.findPetByName"</span><span class="token punctuation">,</span> query <span class="token operator">=</span> <span class="token string">"select p from Pet p where p.name = :NAME"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token annotation punctuation">@NamedQuery</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"Pet.findAll"</span><span class="token punctuation">,</span> query <span class="token operator">=</span> <span class="token string">"select p from Pet p"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Pet</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token annotation punctuation">@Id</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">IDENTITY</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token annotation punctuation">@NotBlank</span></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token annotation punctuation">@Column</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"PET_NAME"</span><span class="token punctuation">,</span> nullable <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">,</span> unique <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token annotation punctuation">@PastOrPresent</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">LocalDate</span> birthDate<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token annotation punctuation">@Transient</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Integer</span> age<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token annotation punctuation">@Enumerated</span><span class="token punctuation">(</span><span class="token class-name">EnumType</span><span class="token punctuation">.</span><span class="token constant">STRING</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">PetType</span> type<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre></pre></td></tr><tr><td data-num="24"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Boolean</span> adopted<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token comment">// bi-directional relationship - non-owning (inverse) side</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token annotation punctuation">@ManyToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"adoptedPets"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Adopter</span><span class="token punctuation">></span></span> owners <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    ···</pre></td></tr><tr><td data-num="30"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight java"><figcaption data-lang="java"><span>Adopter.java</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Entity</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Adopter</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ···</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// bi-directional relationship - non-owning (inverse) side</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"adopter"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Appointment</span><span class="token punctuation">></span></span> appointments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment">// bi-directional relationship - owning side</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token annotation punctuation">@ManyToMany</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token annotation punctuation">@JoinTable</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"ADOPTED_PETS"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>            joinColumns <span class="token operator">=</span> <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"ADOPTER_ID"</span><span class="token punctuation">)</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>            inverseJoinColumns <span class="token operator">=</span> <span class="token annotation punctuation">@JoinColumn</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">"PET_ID"</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Pet</span><span class="token punctuation">></span></span> adoptedPets <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre></pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">Adopter</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="17"></td><td><pre></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment">// helper methods for collections</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">addAdoptedPet</span><span class="token punctuation">(</span><span class="token class-name">Pet</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>adoptedPets<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="21"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>adoptedPets<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>p<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>            p<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="27"></td><td><pre></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">removeAdoptedPet</span><span class="token punctuation">(</span><span class="token class-name">Pet</span> p<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>adoptedPets<span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token keyword">this</span><span class="token punctuation">.</span>adoptedPets<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">contains</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            p<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    ···</pre></td></tr><tr><td data-num="37"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight java"><figcaption data-lang="java"><span>Vet.java</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Entity</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Vet</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ···</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// bi-directional relationship - non-owning (inverse) side</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token annotation punctuation">@OneToMany</span><span class="token punctuation">(</span>mappedBy <span class="token operator">=</span> <span class="token string">"vet"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">Appointment</span><span class="token punctuation">></span></span> appointments <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">Vet</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    ···</pre></td></tr><tr><td data-num="11"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><figure class="highlight java"><figcaption data-lang="java"><span>Appointment.java</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Entity</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Appointment</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    ···</pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token comment">// uni-directional relationship</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token annotation punctuation">@ManyToOne</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Pet</span> pet<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    </pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token comment">// bi-directional relationship - owning side</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token annotation punctuation">@ManyToOne</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Vet</span> vet<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">// bi-directional relatinoship - owning side</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token annotation punctuation">@ManyToOne</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token keyword">private</span> <span class="token class-name">Adopter</span> adopter<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="15"></td><td><pre>    </pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">Appointment</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    ···</pre></td></tr><tr><td data-num="19"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h2 id="ordering-relationships"><a class="anchor" href="#ordering-relationships">#</a> Ordering Relationships</h2><dl><dt><code>@OrderBy</code> (Goncalves Ex49)</dt><dd>No effect on database schema</dd><dt><code>@OrderColumn</code> (Goncalves Ex51)</dt><dd>Impacts database schema</dd></dl><h2 id="inheritance"><a class="anchor" href="#inheritance">#</a> Inheritance</h2><h3 id="inheritance-mappings-继承映射"><a class="anchor" href="#inheritance-mappings-继承映射">#</a> Inheritance Mappings 继承映射</h3><ul><li><code>SINGLE_TABLE</code> strategy<ul><li>A single table per class hierarchy</li><li><code>@DiscriminatorValue</code> (Goncalves Ch5 Ex56)</li></ul></li><li><code>JOINED</code> strategy (Goncalves Ch5 Ex59)</li><li><code>TABLE_PER_CLASS</code> strategy (Ch5 Ex60)<ul><li>This strategy is not required by the JPA specification. Avoid for more portable code.<br>JPA 规范不需要此策略。避免使用更多可移植的代码。</li></ul></li></ul><h3 id="inheritance-hierarchy-继承层次"><a class="anchor" href="#inheritance-hierarchy-继承层次">#</a> Inheritance Hierarchy 继承层次</h3><ul><li>Entities can inherit from<br>实体可以继承<ul><li>Entity superclasses (as we have just seen with inheritance mapping)<br>实体超类（就像我们在继承映射中看到的那样）</li><li>Nonentity superclasses (Goncalves Ch5 Ex63)<br>非实体超类</li></ul></li></ul><p><code>@MappedSuperclass</code> (Goncalves Ch5 Ex66)<br>- Contain persistent state and mappings, but are not entities<br>包含持久状态和映射，但不是实体</p><figure class="highlight java"><figcaption data-lang="java"><span>AbstractEntity.java</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@MappedSuperclass</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">AbstractEntity</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    </pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token annotation punctuation">@Id</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token annotation punctuation">@GeneratedValue</span><span class="token punctuation">(</span>strategy <span class="token operator">=</span> <span class="token class-name">GenerationType</span><span class="token punctuation">.</span><span class="token constant">IDENTITY</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token keyword">protected</span> <span class="token class-name">Long</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="7"></td><td><pre></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token annotation punctuation">@HotSpotIntrinsicCandidate</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">AbstractEntity</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="11"></td><td><pre></pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token keyword">public</span> <span class="token class-name">Long</span> <span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="13"></td><td><pre>        <span class="token keyword">return</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setId</span><span class="token punctuation">(</span><span class="token class-name">Long</span> id<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">=</span> id<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="19"></td><td><pre></pre></td></tr><tr><td data-num="20"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token keyword">int</span> hash <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        hash <span class="token operator">=</span> <span class="token number">71</span> <span class="token operator">*</span> hash <span class="token operator">+</span> <span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token keyword">return</span> hash<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token annotation punctuation">@Override</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">equals</span><span class="token punctuation">(</span><span class="token class-name">Object</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span> <span class="token operator">==</span> obj<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span>obj <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="35"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> obj<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="38"></td><td><pre>        </pre></td></tr><tr><td data-num="39"></td><td><pre>        <span class="token keyword">final</span> <span class="token class-name">AbstractEntity</span> other <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">AbstractEntity</span><span class="token punctuation">)</span> obj<span class="token punctuation">;</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        </pre></td></tr><tr><td data-num="41"></td><td><pre>        <span class="token comment">// because I am using a database generated ID, I need to explicitly check entity id's for null</span></pre></td></tr><tr><td data-num="42"></td><td><pre>        <span class="token comment">// if null, they should not be compared</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>other<span class="token punctuation">.</span>id <span class="token operator">==</span> <span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="44"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        </pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token class-name">Objects</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>id<span class="token punctuation">,</span> other<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>            <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="50"></td><td><pre>        <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="52"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure><h3 id="cascading-级联"><a class="anchor" href="#cascading-级联">#</a> Cascading 级联</h3><table><thead><tr><th>Cascade</th><th>Type Description</th></tr></thead><tbody><tr><td><p><code>PERSIST</code></p></td><td><p>Cascades persist operations to the target of the association<br>级联将操作保持到关联目标</p></td></tr><tr><td><p><code>REMOVE</code></p></td><td><p>Cascades remove operations to the target of the association<br>级联删除对关联目标的操作</p></td></tr><tr><td><p><code>MERGE</code></p></td><td><p>Cascades merge operations to the target of the association<br>级联将操作合并到关联的目标</p></td></tr><tr><td><p><code>REFRESH</code></p></td><td><p>Cascades refresh operations to the target of the association<br>级联刷新操作以达到关联目标</p></td></tr><tr><td><p><code>DETACH</code></p></td><td><p>Cascades detach operations to the target of the association<br>级联将操作分离到关联目标</p></td></tr><tr><td><p><code>ALL</code></p></td><td><p>Declares that all the previous operations should be cascaded<br>声明所有先前的操作都应级联</p></td></tr></tbody></table><h2 id="concurrency-并发"><a class="anchor" href="#concurrency-并发">#</a> Concurrency 并发</h2><ul><li><p>Versioning</p><ul><li><code>@Version</code> read-only attribute</li><li>Not required, but recommended if the entity can be modified concurrently by more than one process or thread</li><li>Automatically enables optimistic locking</li></ul></li><li><p>Locking</p><ul><li>Optimistic – Obtain lock before commit</li><li>Pessimistic – Very resource intensive</li></ul></li><li><p>Goncalves Chapter 6 Example 36</p></li></ul><h3 id="optimistic-locking"><a class="anchor" href="#optimistic-locking">#</a> Optimistic Locking</h3><p><img data-src="https://i.loli.net/2021/03/02/EHmDtBRiZsqGN4I.jpg" alt=""></p><h2 id="callbacks"><a class="anchor" href="#callbacks">#</a> Callbacks</h2><p><img data-src="https://i.loli.net/2021/03/02/USbrjRK1wWfdLNF.jpg" alt=""></p><table><thead><tr><th>Annotation</th><th>Description</th></tr></thead><tbody><tr><td><code>@PrePersist</code></td><td>Marks a method to be invoked before <code>EntityManager.persist()</code> is executed.</td></tr><tr><td><code>@PostPersist</code></td><td>Marks a method to be invoked after the entity has been persisted. If the entity autogenerates its primary key (with <code>@GeneratedValue</code> ), the value is available in the method.</td></tr><tr><td><code>@PreUpdate</code></td><td>Marks a method to be invoked before a database update operation is performed(calling the entity setters or the <code>EntityManager.merge()</code> method).</td></tr><tr><td><code>@PostUpdate</code></td><td>Marks a method to be invoked after a database update operation is performed.</td></tr><tr><td><code>@PreRemove</code></td><td>Marks a method to be invoked before <code>EntityManager.remove()</code> is executed.</td></tr><tr><td><code>@PostRemove</code></td><td>Marks a method to be invoked after the entity has been removed.</td></tr><tr><td><code>@PostLoad</code></td><td>Marks a method to be invoked after an entity is loaded (with a JPQL query or an <code>EntityManager.find()</code> ) or refreshed from the underlying database</td></tr></tbody></table><h3 id="entity-listeners"><a class="anchor" href="#entity-listeners">#</a> Entity Listeners</h3><p>Can be used to extract the business logic to a class for re-use among multiple entities.<br>可用于将业务逻辑提取到一个类中，以便在多个实体之间重用。</p><p>Goncalves Chapter 6 Examples 39 and 42</p><h3 id="callback-methods"><a class="anchor" href="#callback-methods">#</a> Callback Methods</h3><p>Work well when you have business logic only related to that entity.<br>当您仅具有与该实体相关的业务逻辑时，可以很好地工作。</p><p>Goncalves Chapter 6 Example 38</p><h1 id="lab"><a class="anchor" href="#lab">#</a> Lab</h1><h2 id="summary"><a class="anchor" href="#summary">#</a> Summary</h2><p>The purpose of this assignment is to expand our final project business domain with additional entities, implement relationships within our business domain, explore the JPA requirements for applications to manage both sides of bi-directional relationships, and demonstrate with JUnit test cases.  Finally, this project also incorporates both a maven web application and JUnit testing within the same project, demonstrating the use of two separate persistence units, one JTA (for use by Payara while running our web application) and one RESOURCE_LOCAL (from use by Java SE while running unit tests).</p><h2 id="requirements"><a class="anchor" href="#requirements">#</a> Requirements</h2><h3 id="documentation"><a class="anchor" href="#documentation">#</a> Documentation</h3><p>You can take a break from the wiki this week.  No docs required for this lab.  I will be asking you to write about your Final Project design in detail, including the relationships between your entities, on the written Midterm - so use this Lab to experiment with your relationships, and document the design on the written Midterm question.</p><h3 id="database-setup"><a class="anchor" href="#database-setup">#</a> Database Setup</h3><p>Use your itmd4515 database and user from Lab 2 - Setup and Introductory Webapp.</p><h3 id="project-setup"><a class="anchor" href="#project-setup">#</a> Project Setup</h3><p>Your uid-fp repository should already be setup, and you should continue pushing your commits into GitHub for this lab.</p><blockquote><p>Deviating from the package convention given above will mean that you can not benefit from Sonar and other automated tools, and I will not be able to fix this. Please follow the specification!</p><p>We will be working in this repository from now until the end of the semester.  Please remember, I will be looking for multiple commits.  I would suggest using the lab number in your commit message as a prefix so you can also review the history throughout the semester, for example:</p><ul><li>Lab 6 - Initial Commit</li><li>Lab 6 - OneToOne unidirectional relationship between Foo and Bar</li><li>Lab 6 - Test cases for unidirectional 1:1 relationship between Foo and Bar</li><li>Lab 6 - ManyToMany bidirectional relationship between Widget and Gizmo</li><li>Lab 6 - Test cases for bidirectional M:M relationship between Widget and Gizmo</li></ul></blockquote><h3 id="project-requirements"><a class="anchor" href="#project-requirements">#</a> Project Requirements</h3><ol><li><p>If you haven't already (from <a href="/computer-science/mse/itmd-515/lab-4/">Lab 4 - Web Applications, Servlet and JSP</a>), define a JDBC Resource for use by your application.  There are <span class="exturl" data-url="aHR0cHM6Ly9ibG9nLnBheWFyYS5maXNoL2FuLWludHJvLXRvLWNvbm5lY3Rpb24tcG9vbHMtaW4tcGF5YXJhLXNlcnZlci01">many many ways</span> to do this:</p><ol><li>Creating a Payara JDBC Connection Pool and JDBC Resource via the admin console</li><li>Creating a Payara JDBC Connection Pool and JDBC Resource via the asadmin command line utility</li><li>Defining a JDBC Resource directly in Payara domain configuration file</li><li>Defining a JDBC Resource via web.xml</li><li>Defining a JDBC Resource via annotations in our code (this is what we are going to do.  the others might be more useful if you are hosting multiple applications in one server that could share a data source)</li></ol></li><li><p>Your <code>@DataSourceDefinition</code> should look something like below  If you have multiple parameters in your JDBC URL, you would include them as parameters via the annotation  <strong>Note</strong> - depending your operating system, you may also need to add <code>useSSL=false</code> .</p><blockquote><p><strong>Important - If you are re-using your DataSourceDefinition from Lab 4, make sure you don't forget to change the databaseName to itmd4515 like me!</strong></p></blockquote><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@DataSourceDefinition</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    name <span class="token operator">=</span> <span class="token string">"java:app/jdbc/itmd4515DS"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    className <span class="token operator">=</span> <span class="token string">"com.mysql.cj.jdbc.MysqlDataSource"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    portNumber <span class="token operator">=</span> <span class="token number">3306</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    serverName <span class="token operator">=</span> <span class="token string">"localhost"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    databaseName <span class="token operator">=</span> <span class="token string">"itmd4515"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="7"></td><td><pre>    user <span class="token operator">=</span> <span class="token string">"itmd4515"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    password <span class="token operator">=</span> <span class="token string">"itmd4515"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    properties <span class="token operator">=</span> <span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token string">"zeroDateTimeBehavior=CONVERT_TO_NULL"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token string">"serverTimezone=America/Chicago"</span><span class="token punctuation">,</span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token string">"useSSL=false"</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr></table></figure></li><li><p>Consider the deployment of your MySQL JDBC Driver.  Assuming you are also using a  <code>@DataSourceDefinition</code> , you should be able to include the JDBC driver with your application by ensuring it has default scope in your pom.xml as I am showing in class.  Alternatively, you can copy the MySQL JDBC jar file to your Payara domain's <strong>lib/ext</strong> (extensions) folder.</p></li><li><p>Move your <strong>RESOURCE_LOCAL</strong> Persistence Unit from <a href="/computer-science/mse/itmd-515/lab-5/">Lab 5 - ORM and JPA</a> named <strong>itmd4515testPU</strong> to an appropriate location for testing.  In class, I will demonstrate that you can create this manually in the Files view by creating a <code>src/test/resources</code> folder, and then moving your <code>persistence.xml</code> .  This may also necessitate specifying entities within the persistence unit - I will demonstrate this in class.</p></li><li><p>Create a new <strong>JTA</strong> Persistence Unit named <strong>itmd4515PU</strong> connecting to your <strong>itmd4515</strong> database using the <strong>itmd4515</strong> user.  NetBeans seems to have lost the ability to create a JTA <code>persistence.xml</code> , so create this manually by copying your test <code>persistence.xml</code> to the right location and modifying as shown in class.</p><blockquote><p>Once complete, you should have two <code>persistence.xml</code> files:</p><p><code>src/main/resources/META-INF/persistence.xml</code> <em>and</em> <code>src/test/resources/META-INF/persistence.xml</code></p><p>Make sure the Persistence Unit defined in each file has a different name, and that your test class refer to the <strong>itmd4515testPU</strong> PU.  We will move forward with test cases pointing to a &quot;test&quot; PU, and the web application pointing to a &quot;production&quot; PU.</p><p>Make sure you double-check your <code>pom.xml</code> in case the NetBeans persistence wizard added an additional JPA dependency.  if so, remove it.  Your dependencies should continue to look like <a href="/computer-science/mse/itmd-515/lab-5/">Lab 5 - ORM and JPA</a>.</p></blockquote><details><summary>code</summary><div><figure class="highlight xml"><figcaption data-lang="XML"><span>src/main/resources/META-INF/persistence.xml</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2.2<span class="token punctuation">"</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://java.sun.com/xml/ns/persistence<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">&lt;!-- Define Persistence Unit --></span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence-unit</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itmd4515PU<span class="token punctuation">"</span></span> <span class="token attr-name">transaction-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>JTA<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>jta-data-source</span><span class="token punctuation">></span></span>java:app/jdbc/itmd4515DS<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>jta-data-source</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude-unlisted-classes</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude-unlisted-classes</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>        </pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.persistence.schema-generation.database.action<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>drop-and-create<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence-unit</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence</span><span class="token punctuation">></span></span></pre></td></tr></table></figure><figure class="highlight xml"><figcaption data-lang="XML"><span>src/test/resources/META-INF/persistence.xml</span></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token prolog">&lt;?xml version="1.0" encoding="UTF-8"?></span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence</span> <span class="token attr-name">version</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>2.2<span class="token punctuation">"</span></span> <span class="token attr-name">xmlns</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://java.sun.com/xml/ns/persistence<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xmlns:</span>xsi</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://www.w3.org/2001/XMLSchema-instance<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">xsi:</span>schemaLocation</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>http://xmlns.jcp.org/xml/ns/persistence http://xmlns.jcp.org/xml/ns/persistence/persistence_2_2.xsd<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token comment">&lt;!-- Define Persistence Unit --></span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>persistence-unit</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itmd4515testPU<span class="token punctuation">"</span></span> <span class="token attr-name">transaction-type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>RESOURCE_LOCAL<span class="token punctuation">"</span></span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>class</span><span class="token punctuation">></span></span>edu.iit.sat.itmd4515.sliu136.domian.Album<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>class</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>exclude-unlisted-classes</span><span class="token punctuation">></span></span>false<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>exclude-unlisted-classes</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>properties</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="8"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.persistence.jdbc.url<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jdbc:mysql://localhost:3306/itmd4515?zeroDateTimeBehavior=CONVERT_TO_NULL<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="9"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.persistence.jdbc.user<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itmd4515<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="10"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.persistence.jdbc.driver<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.mysql.cj.jdbc.Driver<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="11"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.persistence.jdbc.password<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>itmd4515<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="12"></td><td><pre>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>property</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>javax.persistence.schema-generation.database.action<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>drop-and-create<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>properties</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="14"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence-unit</span><span class="token punctuation">></span></span></pre></td></tr><tr><td data-num="15"></td><td><pre><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>persistence</span><span class="token punctuation">></span></span></pre></td></tr></table></figure></div></details></li><li><p>If necessary, re-factor your entity classes so that they reside in a dedicated domain or model sub-package.  If necessary, update your test class(es) to reside in the same package.</p></li><li><p>Based on your design thoughts from <a href="/computer-science/mse/itmd-515/lab-5/">Lab 5 - ORM and JPA</a>, introduce additional entities to your business domain.  The requirements are:</p><ol><li><p>You must have at least four total entities in your <strong>business domain</strong>.  You may have as many as you want, but at least four.</p></li><li><p>Remember, your final project must support the logical concept of multiple types of users or roles, but <strong>do not</strong> create these as entities. We must consider this now so we can introduce security in later projects, and we will use the JEE security framework to introduce these security entities later.  Likewise, do not create Admin as an entity.  <strong>Stay focused on entities within your domain.</strong></p></li></ol></li><li><p>As before, all your entities should:</p><ol><li><p>Use an appropriate PK strategy, and use an appropriate data type for your PK (as per the options discussed in class)</p></li><li><p>Include appropriate equals and hashCode methods for your PK strategy</p></li><li><p>Include at least one temporal data type</p></li><li><p>Include at least three different data types.  There is no limit to the number of attributes you can include.  Your attributes should be sufficient to represent your entity.  Exercise good design and judgment.</p></li><li><p>Include appropriate Constructors, accessors and mutators</p></li><li><p>Include appropriate bean validation constraints based on your database types and sizes</p></li><li><p>Include appropriate toString method for formatted output</p></li><li><p>In other words, your entities should <strong>make sense.</strong>  Do not use mine from class demo.  I am coding fast and furious, to try and demonstrate all you need for 1 week in a few hours.</p></li></ol></li><li><p>Include at least three relationships between your entities</p><ol><li>At least one of the relationships must be bi-directional</li><li>Try and use different relationship types.  I will not look favorably on 3 OneToOne uni-directional relationships.  This is for you to learn about relationships, and to learn about relationships you need to introduce some real relationships into your business domain.</li></ol></li><li><p>Include appropriate helper methods in your business domain to manage both sides of the relationship.  Will be demonstrated in class.</p></li><li><p>Two JUnit test cases to illustrate that your relationships are working as expected:</p><ol><li>One Uni-directional relationship test case</li><li>One Bi-directional relationship test case<ol><li>Consider the example I worked through in class.  You can assert that persist was successful, and that collections on both sides of a bi-directional relationship contain the expected entity.</li></ol></li></ol><details><summary>code</summary><div><figure class="highlight java"><figcaption data-lang="java"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token annotation punctuation">@Test</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">testAdopterPetManyToManyBiDirectionalRelationship</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="3"></td><td><pre>    <span class="token comment">// create entities to test</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token class-name">Pet</span> cat <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Pet</span><span class="token punctuation">(</span><span class="token string">"Fluffy"</span><span class="token punctuation">,</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">2020</span><span class="token punctuation">,</span> <span class="token class-name">Month</span><span class="token punctuation">.</span><span class="token constant">DECEMBER</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">PetType</span><span class="token punctuation">.</span><span class="token constant">FELINE</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="5"></td><td><pre>    <span class="token class-name">Adopter</span> adopter <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Adopter</span><span class="token punctuation">(</span><span class="token string">"Scott"</span><span class="token punctuation">,</span> <span class="token string">"Spyrison"</span><span class="token punctuation">,</span> <span class="token class-name">LocalDate</span><span class="token punctuation">.</span><span class="token function">of</span><span class="token punctuation">(</span><span class="token number">1950</span><span class="token punctuation">,</span> <span class="token class-name">Month</span><span class="token punctuation">.</span><span class="token constant">MARCH</span><span class="token punctuation">,</span> <span class="token number">12</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    </pre></td></tr><tr><td data-num="7"></td><td><pre>    <span class="token comment">// ex 1 - I demonstrated, without any relationship management these are just two indepednent entities with no relationship</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    </pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token comment">// ex 2 - Add the adopter to the inverse side of the relationship.  If you only do this, and you don't manage the owning side, then you will have inconsistent database updates</span></pre></td></tr><tr><td data-num="10"></td><td><pre>    <span class="token comment">//cat.getOwners().add(adopter);</span></pre></td></tr><tr><td data-num="11"></td><td><pre>    </pre></td></tr><tr><td data-num="12"></td><td><pre>    <span class="token comment">// ex 3 - Manage the owning side, but skip the non-owning inverse side</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token comment">//adopter.getAdoptedPets().add(cat);</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    </pre></td></tr><tr><td data-num="15"></td><td><pre>    <span class="token comment">// ex 4 - Manage both sides of the relationship per JPA requirements</span></pre></td></tr><tr><td data-num="16"></td><td><pre>    <span class="token comment">// and Prof Scott lecture!</span></pre></td></tr><tr><td data-num="17"></td><td><pre>    <span class="token comment">// adopter.getAdoptedPets().add(cat);</span></pre></td></tr><tr><td data-num="18"></td><td><pre>    <span class="token comment">// cat.getOwners().add(adopter);</span></pre></td></tr><tr><td data-num="19"></td><td><pre>    adopter<span class="token punctuation">.</span><span class="token function">addAdoptedPet</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="20"></td><td><pre>    </pre></td></tr><tr><td data-num="21"></td><td><pre>    tx<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="22"></td><td><pre>    em<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="23"></td><td><pre>    em<span class="token punctuation">.</span><span class="token function">persist</span><span class="token punctuation">(</span>adopter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="24"></td><td><pre>    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="25"></td><td><pre>    </pre></td></tr><tr><td data-num="26"></td><td><pre>    adopter <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Adopter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> adopter<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="27"></td><td><pre>    cat <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Pet</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> cat<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="28"></td><td><pre>    <span class="token comment">// ex 3 continued - let's explore the persistence context for this relationship</span></pre></td></tr><tr><td data-num="29"></td><td><pre>    <span class="token comment">// this is navigation from the OWNING side</span></pre></td></tr><tr><td data-num="30"></td><td><pre>    <span class="token comment">//System.out.println("OWNING SIDE: " + adopter.getAdoptedPets().toString());</span></pre></td></tr><tr><td data-num="31"></td><td><pre></pre></td></tr><tr><td data-num="32"></td><td><pre>    <span class="token comment">//for( Pet p : adopter.getAdoptedPets())&#123;</span></pre></td></tr><tr><td data-num="33"></td><td><pre>        <span class="token comment">// this is navigation from the INVERSE side</span></pre></td></tr><tr><td data-num="34"></td><td><pre>        <span class="token comment">//System.out.println("INVERSE SIDE: " + p.getOwners().toString());</span></pre></td></tr><tr><td data-num="35"></td><td><pre>    <span class="token comment">//&#125;</span></pre></td></tr><tr><td data-num="36"></td><td><pre>    <span class="token comment">// ex 3 fails in the PersistenceContext because we didn't manage both sides of the relationships.</span></pre></td></tr><tr><td data-num="37"></td><td><pre>    <span class="token comment">// PersistenceContext is out of sync with the database update</span></pre></td></tr><tr><td data-num="38"></td><td><pre>    </pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token comment">// ex 4</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    adopter <span class="token operator">=</span> em<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token class-name">Adopter</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">,</span> adopter<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="41"></td><td><pre>    <span class="token comment">// this is navigation from the OWNING side</span></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"OWNING SIDE: "</span> <span class="token operator">+</span> adopter<span class="token punctuation">.</span><span class="token function">getAdoptedPets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="43"></td><td><pre></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token keyword">for</span><span class="token punctuation">(</span> <span class="token class-name">Pet</span> p <span class="token operator">:</span> adopter<span class="token punctuation">.</span><span class="token function">getAdoptedPets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span></pre></td></tr><tr><td data-num="45"></td><td><pre>        <span class="token comment">// this is navigation from the INVERSE side</span></pre></td></tr><tr><td data-num="46"></td><td><pre>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"INVERSE SIDE: "</span> <span class="token operator">+</span> p<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="47"></td><td><pre>    <span class="token punctuation">&#125;</span></pre></td></tr><tr><td data-num="48"></td><td><pre>    <span class="token comment">// ex 4 - our database update is consistent with both sides of our relationship</span></pre></td></tr><tr><td data-num="49"></td><td><pre>    <span class="token comment">// and persistence context is in sync with database</span></pre></td></tr><tr><td data-num="50"></td><td><pre></pre></td></tr><tr><td data-num="51"></td><td><pre>    <span class="token comment">// travel both sides of the relationship and assert what we find is expected</span></pre></td></tr><tr><td data-num="52"></td><td><pre>    <span class="token function">assertTrue</span><span class="token punctuation">(</span>adopter<span class="token punctuation">.</span><span class="token function">getAdoptedPets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="53"></td><td><pre>    <span class="token function">assertTrue</span><span class="token punctuation">(</span>cat<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="54"></td><td><pre>    <span class="token function">assertEquals</span><span class="token punctuation">(</span>cat<span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> adopter<span class="token punctuation">.</span><span class="token function">getAdoptedPets</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="55"></td><td><pre>    <span class="token function">assertEquals</span><span class="token punctuation">(</span>adopter<span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> cat<span class="token punctuation">.</span><span class="token function">getOwners</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="56"></td><td><pre>    </pre></td></tr><tr><td data-num="57"></td><td><pre>    <span class="token comment">// clean up after ourselves - remove test data</span></pre></td></tr><tr><td data-num="58"></td><td><pre>    tx<span class="token punctuation">.</span><span class="token function">begin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="59"></td><td><pre>    <span class="token comment">// first, remove from the collection</span></pre></td></tr><tr><td data-num="60"></td><td><pre>    adopter<span class="token punctuation">.</span><span class="token function">removeAdoptedPet</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="61"></td><td><pre>    <span class="token comment">// then, remove the non-owning entity</span></pre></td></tr><tr><td data-num="62"></td><td><pre>    em<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>cat<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="63"></td><td><pre>    <span class="token comment">// finally, remove the owning entity</span></pre></td></tr><tr><td data-num="64"></td><td><pre>    em<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>adopter<span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="65"></td><td><pre>    tx<span class="token punctuation">.</span><span class="token function">commit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></pre></td></tr><tr><td data-num="66"></td><td><pre>    </pre></td></tr><tr><td data-num="67"></td><td><pre><span class="token punctuation">&#125;</span></pre></td></tr></table></figure></div></details></li><li><p>Please feel free to use Sonar to analyze your code before submitting.  I have created Sonar projects for everyone.</p></li><li><p>Submit to Blackboard</p><ol><li>Right your <strong>uid-fp</strong> project and select &quot;Clean&quot;</li><li>Go to your NetBeans Projects directory.  Create a zip file of the <strong>uid-fp</strong> folder and submit it to the Blackboard assignment.</li></ol></li></ol><h3 id="extra-credit"><a class="anchor" href="#extra-credit">#</a> Extra Credit</h3><p>Graduate Students must also introduce JPA functionality to your existing web application by refactoring your Servlet from <a href="/computer-science/mse/itmd-515/lab-4/">Lab 4 - Web Applications, Servlet and JSP</a> to use an EntityManager and UserTransaction instead of JDBC.  This will require the following:</p><ol><li>Change your Lab 4 POJO to an Entity.<ol><li>In most cases this will be as simple as adding an <code>@Entity</code> and <code>@Id</code> annotation to the class!</li><li>If you run into sample database complications with the primary key, just add an auto-incrementing  <code>@Id</code> field to the class.</li><li>Don't over-think this part - I just want you to get the experience of using the <code>@PersistenceConext</code> annotation in your existing Servlet, and I want you to see how much easier it is to <code>em.persist</code> than use all that <code>PreparedStatement</code> code!</li></ol></li><li>Obtain an <code>EntityManager</code> using <code>@PersistenceContext</code> injection, and a <code>UserTransaction</code> using <code>resource</code> injection.</li><li>If user input from your form passes validation in your Servlet controller, persist the entity to the database.  How easy is that?  Easier than JDBC?</li></ol><p>By the end of your refactoring, you should not have any JDBC code left in your project, nor should you be using the <code>@DataSource</code> annotation.  Will demo in class.</p><div class="tags"><a href="/tags/Java/" rel="tag"><i class="ic i-tag"></i> Java</a></div></div><footer><div class="meta"><span id="computer-science/mse/itmd-515/lab-6/" class="item leancloud_visitors" data-flag-title="Lab 6. JPA Relationships" title="Views"><span class="icon"><i class="ic i-eye"></i> </span><span class="text">Views</span> <span class="leancloud-visitors-count"></span> <span class="text">times</span></span></div><div class="reward"><button><i class="ic i-heartbeat"></i> 赞赏</button><p>请我喝[茶]~(￣▽￣)~*</p><div id="qr"><div><img data-src="/images/wechatpay.png" alt="Ruri Shimotsuki 微信支付"><p>微信支付</p></div><div><img data-src="/images/alipay.png" alt="Ruri Shimotsuki 支付宝"><p>支付宝</p></div><div><img data-src="/images/paypal.png" alt="Ruri Shimotsuki 贝宝"><p>贝宝</p></div></div></div><div id="copyright"><ul><li class="author"><strong>Post author: </strong>Ruri Shimotsuki <i class="ic i-at"><em>@</em></i>優萌初華</li><li class="link"><strong>Post link: </strong><a href="https://shoka.lostyu.me/computer-science/mse/itmd-515/lab-6/" title="Lab 6. JPA Relationships">https://shoka.lostyu.me/computer-science/mse/itmd-515/lab-6/</a></li><li class="license"><strong>Copyright Notice: </strong>All articles in this blog are licensed under <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> unless stating additionally.</li></ul></div></footer></article></div><div class="post-nav"><div class="item left"><a href="/computer-science/mse/itmd-515/lab-5/" itemprop="url" rel="prev" data-background-image="https:&#x2F;&#x2F;img.timelessq.com&#x2F;images&#x2F;2022&#x2F;07&#x2F;26&#x2F;de8e4ab9f6942742165c7e05ff1e1f4f.jpg" title="Lab 5. ORM and JPA"><span class="type">Previous Post</span> <span class="category"><i class="ic i-flag"></i> ITMD 515. Advanced Software Programming</span><h3>Lab 5. ORM and JPA</h3></a></div><div class="item right"><a href="/computer-science/mse/itmm-571/lecture-4/" itemprop="url" rel="next" data-background-image="https:&#x2F;&#x2F;img.timelessq.com&#x2F;images&#x2F;2022&#x2F;07&#x2F;26&#x2F;a05ebdd3b7f197e626fa1253c6521ef5.jpg" title="Lecture 4. Scope Management"><span class="type">Next Post</span> <span class="category"><i class="ic i-flag"></i> ITMM 571. Project Management</span><h3>Lecture 4. Scope Management</h3></a></div></div><div class="wrap" id="comments"></div></div><div id="sidebar"><div class="inner"><div class="panels"><div class="inner"><div class="contents panel pjax" data-title="Contents"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#notes"><span class="toc-number">1.</span> <span class="toc-text">Notes</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#collections-of-basic-types"><span class="toc-number">1.1.</span> <span class="toc-text">Collections of Basic Types</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#relationship-mapping"><span class="toc-number">1.2.</span> <span class="toc-text">Relationship Mapping</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#unidirectional"><span class="toc-number">1.2.1.</span> <span class="toc-text">Unidirectional</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bidirectional"><span class="toc-number">1.2.2.</span> <span class="toc-text">Bidirectional</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#one-to-one"><span class="toc-number">1.2.3.</span> <span class="toc-text">One-to-One</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#one-to-many"><span class="toc-number">1.2.4.</span> <span class="toc-text">One-to-Many</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#many-to-one"><span class="toc-number">1.2.5.</span> <span class="toc-text">Many-to-One</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#many-to-many"><span class="toc-number">1.2.6.</span> <span class="toc-text">Many-to-Many</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#relationship-mapping-tips"><span class="toc-number">1.2.7.</span> <span class="toc-text">Relationship Mapping Tips</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bidirectional-relationship-rules"><span class="toc-number">1.2.8.</span> <span class="toc-text">Bidirectional Relationship Rules</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ordering-relationships"><span class="toc-number">1.3.</span> <span class="toc-text">Ordering Relationships</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#inheritance"><span class="toc-number">1.4.</span> <span class="toc-text">Inheritance</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#inheritance-mappings-%E7%BB%A7%E6%89%BF%E6%98%A0%E5%B0%84"><span class="toc-number">1.4.1.</span> <span class="toc-text">Inheritance Mappings 继承映射</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#inheritance-hierarchy-%E7%BB%A7%E6%89%BF%E5%B1%82%E6%AC%A1"><span class="toc-number">1.4.2.</span> <span class="toc-text">Inheritance Hierarchy 继承层次</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#cascading-%E7%BA%A7%E8%81%94"><span class="toc-number">1.4.3.</span> <span class="toc-text">Cascading 级联</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#concurrency-%E5%B9%B6%E5%8F%91"><span class="toc-number">1.5.</span> <span class="toc-text">Concurrency 并发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#optimistic-locking"><span class="toc-number">1.5.1.</span> <span class="toc-text">Optimistic Locking</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#callbacks"><span class="toc-number">1.6.</span> <span class="toc-text">Callbacks</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#entity-listeners"><span class="toc-number">1.6.1.</span> <span class="toc-text">Entity Listeners</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#callback-methods"><span class="toc-number">1.6.2.</span> <span class="toc-text">Callback Methods</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#lab"><span class="toc-number">2.</span> <span class="toc-text">Lab</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#summary"><span class="toc-number">2.1.</span> <span class="toc-text">Summary</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#requirements"><span class="toc-number">2.2.</span> <span class="toc-text">Requirements</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#documentation"><span class="toc-number">2.2.1.</span> <span class="toc-text">Documentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#database-setup"><span class="toc-number">2.2.2.</span> <span class="toc-text">Database Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#project-setup"><span class="toc-number">2.2.3.</span> <span class="toc-text">Project Setup</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#project-requirements"><span class="toc-number">2.2.4.</span> <span class="toc-text">Project Requirements</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#extra-credit"><span class="toc-number">2.2.5.</span> <span class="toc-text">Extra Credit</span></a></li></ol></li></ol></li></ol></div><div class="related panel pjax" data-title="Related"><ul><li><a href="/computer-science/mse/itmd-515/lab-3/" rel="bookmark" title="Lab 3. Junit, JDBC and Bean Validation">Lab 3. Junit, JDBC and Bean Validation</a></li><li><a href="/computer-science/mse/itmd-515/lab-4/" rel="bookmark" title="Lab 4. Web Applications, Servlet and JSP">Lab 4. Web Applications, Servlet and JSP</a></li><li><a href="/computer-science/mse/itmd-515/lab-5/" rel="bookmark" title="Lab 5. ORM and JPA">Lab 5. ORM and JPA</a></li><li class="active"><a href="/computer-science/mse/itmd-515/lab-6/" rel="bookmark" title="Lab 6. JPA Relationships">Lab 6. JPA Relationships</a></li><li><a href="/computer-science/mse/itmd-515/lab-7/" rel="bookmark" title="Lab 7. EJB Service Layer">Lab 7. EJB Service Layer</a></li><li><a href="/computer-science/mse/itmd-515/lab-8/" rel="bookmark" title="Lab 8. Java Server Faces">Lab 8. Java Server Faces</a></li><li><a href="/computer-science/mse/itmd-515/lab-9/" rel="bookmark" title="Lab 9. Web Application Security">Lab 9. Web Application Security</a></li></ul></div><div class="overview panel" data-title="Overview"><div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="image" itemprop="image" alt="Ruri Shimotsuki" data-src="/images/avatar.jpg"><p class="name" itemprop="name">Ruri Shimotsuki</p><div class="description" itemprop="description">琉璃的医学 & 编程笔记</div></div><nav class="state"><div class="item posts"><a href="/archives/"><span class="count">303</span> <span class="name">文章</span></a></div><div class="item categories"><a href="/categories/"><span class="count">68</span> <span class="name">分类</span></a></div><div class="item tags"><a href="/tags/"><span class="count">73</span> <span class="name">标签</span></a></div></nav><div class="social"><span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWU=" title="https:&#x2F;&#x2F;github.com&#x2F;amehime"><i class="ic i-github"></i></span> <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS9hbWVoaW1l" title="https:&#x2F;&#x2F;twitter.com&#x2F;amehime"><i class="ic i-twitter"></i></span> <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9hbWVoaW1l" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;amehime"><i class="ic i-zhihu"></i></span> <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTEyODg2ODIz" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;12886823"><i class="ic i-cloud-music"></i></span> <span class="exturl item telegram" data-url="aHR0cHM6Ly90Lm1lL2FtZWhpbWU=" title="https:&#x2F;&#x2F;t.me&#x2F;amehime"><i class="ic i-paper-plane"></i></span> <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9hbWVoaW1l" title="https:&#x2F;&#x2F;about.me&#x2F;amehime"><i class="ic i-address-card"></i></span></div><ul class="menu"><li class="item"><a href="/" rel="section"><i class="ic i-home"></i>首页</a></li><li class="item dropdown"><a href="/about/" rel="section"><i class="ic i-user"></i>关于</a><ul class="submenu"><li class="item"><a href="/about/yume" rel="section"><i class="ic i-cloud"></i>自设</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a><ul class="submenu"><li class="item"><a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a></li><li class="item"><a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a></li><li class="item"><a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a></li></ul></li><li class="item dropdown"><a href="javascript:void(0);"><i class="ic i-magic"></i>链环</a><ul class="submenu"><li class="item"><a href="/friends/" rel="section"><i class="ic i-heart"></i>友達</a></li><li class="item"><a href="/webstack/" rel="section"><i class="ic i-star"></i>网址</a></li></ul></li><li class="item"><span class="exturl" data-url="aHR0cHM6Ly90cmF2ZWxsaW5ncy5saW5r"><i class="ic i-paper-plane"></i>开往</span></li></ul></div></div></div><ul id="quick"><li class="prev pjax"><a href="/computer-science/mse/itmd-515/lab-5/" rel="prev" title="Previous Post"><i class="ic i-chevron-left"></i></a></li><li class="up"><i class="ic i-arrow-up"></i></li><li class="down"><i class="ic i-arrow-down"></i></li><li class="next pjax"><a href="/computer-science/mse/itmm-571/lecture-4/" rel="next" title="Next Post"><i class="ic i-chevron-right"></i></a></li><li class="percent"></li></ul></div></div><div class="dimmer"></div></div></main><footer id="footer"><div class="inner"><div class="widgets"><div class="rpost pjax"><h2>Random Posts</h2><ul><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/certificate/" title="In 证书">证书</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/certificate/ispm/" title="In 软考高项">软考高项</a></div><span><a href="/computer-science/certificate/ispm/chapter-2/" title="第2章 信息系统项目管理基础">第2章 信息系统项目管理基础</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/" title="In Master of Software Engineering">Master of Software Engineering</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/itmm-571/" title="In ITMM 571. Project Management">ITMM 571. Project Management</a></div><span><a href="/computer-science/mse/itmm-571/lecture-14/" title="Lecture 14. Team LeaderShip">Lecture 14. Team LeaderShip</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/" title="In Master of Software Engineering">Master of Software Engineering</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/itmd-510/" title="In ITMD 510. Object-Oriented App Develop">ITMD 510. Object-Oriented App Develop</a></div><span><a href="/computer-science/mse/itmd-510/week-5/" title="Week 5. Abstraction vs. Interfaces, Inheritance and Polymorphism">Week 5. Abstraction vs. Interfaces, Inheritance and Polymorphism</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/clinical-medicine/" title="In 临床医学">临床医学</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/" title="In 心血管病学">心血管病学</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/echocardiography/" title="In 超声心动图">超声心动图</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/echocardiography/basics/" title="In 第一阶段 Basics">第一阶段 Basics</a></div><span><a href="/clinical-medicine/cardiovascular/echocardiography/basics/course-12/" title="12. Use of Contrast in Echocardiography 超声心动图检查中造影剂的使用">12. Use of Contrast in Echocardiography 超声心动图检查中造影剂的使用</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/cpp/" title="In C++">C++</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/cpp/course-1/" title="In 计算机程序设计（C++）- 西安交通大学">计算机程序设计（C++）- 西安交通大学</a></div><span><a href="/computer-science/cpp/course-1/week-8/" title="第08周 按址操作2：指针与数组、字符串、结构体，动态数组">第08周 按址操作2：指针与数组、字符串、结构体，动态数组</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/" title="In Master of Software Engineering">Master of Software Engineering</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/itmd-514/" title="In ITMD 514. Programming for Data Analytics">ITMD 514. Programming for Data Analytics</a></div><span><a href="/computer-science/mse/itmd-514/week-8/" title="Week 8. Hypothesis Testing 假设检验">Week 8. Hypothesis Testing 假设检验</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/" title="In Master of Software Engineering">Master of Software Engineering</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/itmm-571/" title="In ITMM 571. Project Management">ITMM 571. Project Management</a></div><span><a href="/computer-science/mse/itmm-571/lecture-5/" title="Lecture 5. Cost Management">Lecture 5. Cost Management</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/computer-science/" title="In 计算机科学">计算机科学</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/" title="In Master of Software Engineering">Master of Software Engineering</a> <i class="ic i-angle-right"></i> <a href="/categories/computer-science/mse/itmd-565/" title="In ITMM 565. Rich Internet Applications">ITMM 565. Rich Internet Applications</a></div><span><a href="/computer-science/mse/itmd-565/lecture-1/" title="Lecture 1. JavaScript – Language and Syntax">Lecture 1. JavaScript – Language and Syntax</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/clinical-medicine/" title="In 临床医学">临床医学</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/" title="In 心血管病学">心血管病学</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/echocardiography/" title="In 超声心动图">超声心动图</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/echocardiography/valves/" title="In 第二阶段 Valves">第二阶段 Valves</a></div><span><a href="/clinical-medicine/cardiovascular/echocardiography/valves/course-4/" title="04. Mitral Regurgitation Mechanisms 二尖瓣反流机制">04. Mitral Regurgitation Mechanisms 二尖瓣反流机制</a></span></li><li class="item"><div class="breadcrumb"><a href="/categories/clinical-medicine/" title="In 临床医学">临床医学</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/" title="In 心血管病学">心血管病学</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/structural-heart-disease/" title="In 结构性心脏病">结构性心脏病</a> <i class="ic i-angle-right"></i> <a href="/categories/clinical-medicine/cardiovascular/structural-heart-disease/mitral-valve/" title="In 二尖瓣">二尖瓣</a></div><span><a href="/clinical-medicine/cardiovascular/structural-heart-disease/mitral-valve/note-2/" title="二尖瓣应用解剖">二尖瓣应用解剖</a></span></li></ul></div><div><h2>Recent Comments</h2><ul class="leancloud-recent-comment"></ul></div></div><div class="status"><div class="copyright">&copy; 2010 – <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="ic i-sakura rotate"></i> </span><span class="author" itemprop="copyrightHolder">Ruri Shimotsuki @ Yume Shoka</span></div><div class="count"><span class="post-meta-item-icon"><i class="ic i-chart-area"></i> </span><span title="站点总字数">3.4m 字</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="ic i-coffee"></i> </span><span title="站点阅读时长">51:02</span></div><div class="powered-by">基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span></div></div></div></footer></div><script data-config type="text/javascript">var LOCAL={path:"computer-science/mse/itmd-515/lab-6/",favicon:{show:"（●´3｀●）Goooood",hide:"(´Д｀)Booooom"},search:{placeholder:"Search for Posts",empty:"We didn't find any results for the search: ${query}",stats:"${hits} results found in ${time} ms"},valine:!0,fancybox:!0,copyright:'Copied to clipboard successfully! <br> All articles in this blog are licensed under <i class="ic i-creative-commons"></i>BY-NC-SA.',ignores:[function(e){return e.includes("#")},function(e){return new RegExp(LOCAL.path+"$").test(e)}]}</script><script src="https://cdn.polyfill.io/v2/polyfill.js"></script><script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script><script src="/js/app.js?v=0.2.5"></script><script data-pjax>var _hmt=_hmt||[];!function(){var e=document.createElement("script");e.src="https://hm.baidu.com/hm.js?60ab4a51924a588bb4d810652c9412f1";var t=document.getElementsByTagName("script")[0];t.parentNode.insertBefore(e,t)}()</script></body></html>